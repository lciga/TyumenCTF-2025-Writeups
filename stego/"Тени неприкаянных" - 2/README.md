> Мы отправили по вашей наводке экспедицию.
> 
> На месте, среди голого льда и руин станции наблюдения, нашли контейнер. Внутри лежал носитель данных, больше похожий на макет, чем на реально существующее устройство тех времён.
> 
> Но это не муляж. Формат и объём информации не соответствуют технологиям 1980-х. Похоже, КОНТУР работал с технологиями, до которых мы добрались только сейчас.
> 
> Наши спецы по технической защите информации смогли снять с него данные. Внутри оказался архив. Зашифрованный.
> 
> Вы знаете, что делать дальше.

###  1. Исследование альфа-канала

Загружаем изображение в **StegSolve** (или любой просмотрщик по каналам).  
На вкладке **Alpha plane 1** по верхнему краю изображения видны **едва заметные тёмные пиксели**.

В PNG-файлах альфа-канал обычно либо полностью непрозрачен (255), либо полностью прозрачен (0). Тут же — что-то между, и это уже подозрительно.

###  2. Логика решения

В тех пикселях, где альфа-канал **не равен 255** (в нашем случае — **254**), спрятана информация.  
КОНТУР использовал **LSB-стеганографию** — данные были зашиты в **наименее значимые биты (LSB)** каналов R, G и B.

Каждый такой пиксель даёт 3 бита (по 1 биту из каждого цветового канала).

Пример:
```
R = 10101010 | 0 - LSB 
G = 11111111 | 1 - LSB 
B = 00000001 | 1 - LSB 
```
Результат: **011**

Собираем все такие тройки, склеиваем в одну битовую строку, разбиваем по 8 и конвертируем в ASCII.  
**Каждые 8 бит = 1 символ**.




### 3. Подтверждаем количество "подозрительных" пикселей
```
from PIL import Image

def count(image_path):
    img = Image.open(image_path).convert('RGBA')
    pixels = img.load()
    width, height = img.size

    count = 0
    for y in range(height):
        for x in range(width):
            r, g, b, a = pixels[x, y]
            if a != 255:
                count += 1
    return count

print("number of sus pixels:", count('CONTOUR_PHOTO.png'))

```
В нашем случае, `number of sus pixels:64`. 

Каждый пиксель содержит по 3 бита:  
`64 пикселя × 3 бита = 192 бита = 24 байта = 24 символа`  
Скорее всего, внутри зашито сообщение фиксированной длины (вполне может быть ссылка).

### 4. Извлекаем данные
```
from PIL import Image

def extract(image_path):
    img = Image.open(image_path)
    pixels = img.load()
    width, height = img.size

    bits = []
    for y in range(height):
        for x in range(width):
            r, g, b, a = pixels[x, y]
            if a != 255:
                bits.append(r & 1)
                bits.append(g & 1)
                bits.append(b & 1)

    byte_array = []
    for i in range(0, len(bits), 8):
        byte = bits[i:i + 8]
        if len(byte) == 8:
            byte_val = int(''.join(map(str, byte)), 2)
            byte_array.append(byte_val)

    return ''.join(map(chr, byte_array))

print(extract('CONTOUR_PHOTO.png'))

```

После запуска скрипта получаем ссылку: `https://clck.ru/3LQSN3//`.
Открываем ссылку — и получаем **финальное послание КОНТУРа**.

Флаг: `TyumenCTF{C0NT0UR_w4s_n3v3r_d34d_ju5t_th1nk_tw1c3}`