# Крякнуто с любовью

«Золотое издание! Games for Windows! Перевод от Фаргуса!» — кричала торрент-страница.

Ностальгия — штука сильная. В жизни бы такое не скачал, но других версий просто не нашлось.  
Ладно, вспомним детство... Хотя игра выглядит так, будто детство уже кто-то основательно подпортил.


## Решение:

Очевидно, над игрой изрядно поиздевались. Первое, что должно броситься в глаза — весьма большой размер для старенькой казуалки. 

Проверяем папки с помощью проводника или анализатора типа WinDirStat. Самым тяжёлым файлом оказывается подозрительный ReservedLogo.png, занимающий около 750МБ , что ненормально для картинки.

---

Есть несколько простых способов понять, в чём дело:

### **Способ 1: HEX-анализ** 
Открываем ReservedLogo.png в HEX-редакторе, и замечаем подозрительную структуру данных, совсем не похожую на обычный PNG-файл.

Обычный файл PNG имеет понятную и однородную структуру, в то время как наш ReservedLogo.png наполнен мусором и явно скрытыми данными.

![](Pasted%20image%2020250407013742.png)

Слева — наш файл, справа, его оригинальная версия. Все PNG файлы имеют однородную структуру.
Не обязательно внимательно всматриваться, достаточно просто пробежаться по коду сверху вниз, чтобы заметить аномалию. 

### **Способ 2: Используем binwalk** 
Запускаем команду:

```
binwalk ReservedLogo.png
```

В первых же строках видим упоминание архива

![](Pasted%20image%2020250407014007.png)

---
Теперь нам нужно извлечь флаг. Зная, что мы имеем дело с архивом, у нас есть несколько вариантов

1. Winrar
	1. Открываем файл в файловом менеджере WinRAR, нажимая "Показать содержимое архива"
	2. Нас там ждём несколько мусорных файлов и самое главное: txt-шник с флагом!
	
	[](Pasted%20image%2020250407014350.png)

	![](Pasted%20image%2020250407014419.png)

2) 7-Zip
	1) Просто открываем файл `ReservedLogo.png` двойным кликом и видим содержимое архива

	![](Pasted%20image%2020250407014547.png)

3) strings
	Покажу на примере команды strings на Linux, но извлекать строки можно и через другие программы, тот же WinRAR
	
	
	Пропишем команду `strings ReservedLogo.png | grep TyumenCTF`, и получим сразу же извлечённый флаг

	![](Pasted%20image%2020250407014919.png)

## Флаг
`TyumenCTF{p1r4cy_1s_b4d_bu7_0ld_g4m3z_4r3_h4rd_2_buy}
`