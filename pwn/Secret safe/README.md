# Secret safe
Сейф защищён "умной" системой проверки. Говорят, у него есть секретный страж, который следит за целостностью.

## Решение
В данной задаче требуется переполнить буфер и перезаписать адрес возврата для вызова функции `win()`.

**Уязвимости в программе:**
- Функция `gets()` позволяет записать больше 64 байт, переполняя буфер.

**Сложность**:
- Наличие защиты stack canary.

**Принцип построения полезной нагрузки:**
- 64 байт: Заполняем буфер (например, A).
- 4 байта: Записываем нашу канарейку.
- 12 байт: Пропускаем выравнивание (тоже A).
- 0x080492cf - адрес вызова функции `win`.

Чтобы найти по какому адресу в стеке вызовов находится значение канарейки, нам нужно запустить программу в отладчике и дойти до генерации и записи канарейки, после вывести стек вызовов и посчитать позицию, в котором хранится сгенерированное значение канарейки, это смещение мы и будем использовать в нашем эксплоите.

![](gdb.png)

## Флаг
`TyumenCTF{C@n4rj_Byp@s$}`